(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{180:function(e,n){e.exports={attributes:{title:"Membuat button Like sederhana menggunakan Firebase Realtime Database",slug:"create-simple-like-button-using-firebase-rtdb",date:"2019-02-21",minute2read:10,description:"Berbagi pengalaman dalam menggunakan Firebase RTDB untuk membuat button Like sederhana seperti yang terlihat pada Blog 2.0 ini",categories:["javascript","nuxt","firebase"],cover:"https://www.mazipan.xyz/content-images/create-simple-like-button-using-firebase-rtdb/button-like-firebase.png"},html:'<h2>Latar Belakang</h2>\n<p>Seperti sudah saya jelaskan pada tulisan sebelumnya bahwa Blog 2.0 ini hanyalah sebuah static Blog tanpa Backend, pun saya hanya menggunakan jasa static hosting dari Netlify untuk meletakan dan meyajikan file hasil build. Karena saya tidak menggunakan Backend dan tidak ingin menggunakannya, maka saya kesulitan ketika ingin menambahkan fitur yang mengharuskan saya menyimpan data di basis data (<em>database</em> -DB) seperti jumlah orang yang <em>like</em> suatu artikel. Data seperti itu jelas bukan data yang bisa disimpan di <em>browser</em> masing-masing. Datanya harus terpusat dan semua pengunjung melihat jumlah yang sama. Data seperti ini paling ideal ada di DB, apapun jenis DB yang digunakan.</p>\n<p>Dewasa ini untunglah ada platform seperti <a href="https://firebase.google.com/">Firebase ↗️</a> yang membantu orang-orang yang males bikin Backend namun tetap bisa menyimpan data secara terpusat. Firebase bukan cuma menyediakan DB untuk kita tapi juga jasa lainnya seperti hosting, otentikasi, cloud storage, analytics, A/B testing, remote config, dynamic link dan berbagai hal keren lainnya. Firebase ini ibarat paket komplit kalau kita mau beli makan siang.</p>\n<p>Kali ini kita hanya akan menggunakan fitur real-time databasenya saja.</p>\n<img v-lazyload src="/images/placeholder-1x1.png" data-src="/content-images/create-simple-like-button-using-firebase-rtdb/button-like-firebase.png" alt="Button Like Firebase" height="200px" width="200px">\n<h2>Membuat Projek di Firebase</h2>\n<p>Pertama kalian harus membuat projek di <a href="https://console.firebase.google.com/">Firebase Console ↗️</a>, kalian bisa memberi nama apapun pada projek kalian tapi nama ini memang harus unik dan belum pernah digunakan oleh orang lain.</p>\n<p>Berikutnya kalian akan disuguhi pilihan untuk melakukan setup pada Firebase yang berbeda-beda tergantung jenis projek kalian, kita bisa memilih untuk web dan akan diberikan kode untuk memasang Firebase seperti berikut:</p>\n<pre><code class="language-html">&lt;script src=&quot;https://www.gstatic.com/firebasejs/5.8.3/firebase.js&quot;&gt;&lt;/script&gt;\n&lt;script&gt;\n  // Initialize Firebase\n  var config = {\n    apiKey: &quot;QWERTY-YTREWQ&quot;,\n    authDomain: &quot;contoh-aja.firebaseapp.com&quot;,\n    databaseURL: &quot;https://contoh-aja.firebaseio.com&quot;,\n    projectId: &quot;contoh-aja&quot;,\n    storageBucket: &quot;contoh-aja.appspot.com&quot;,\n    messagingSenderId: &quot;1234567890&quot;\n  };\n  firebase.initializeApp(config);\n&lt;/script&gt;\n</code></pre>\n<p>Kita tidak bisa <em>copy-paste</em> kode ini mentah-mentah, karena projek Blog 2.0 menggunakan Nuxt sebagai framework dan tentu berbeda sedikit cara menggunakannya.</p>\n<p>Sebelum mulai menyiapkan konfigurasi, saya memilih untuk meletakan nilai-nilai konfigurasi ini kedalam file <code>.env</code> agar mudah diubah-ubah nantinya.</p>\n<p>Saya membuat file <code>.env</code> dengan isi berdasarkan konfigurasi yang didapat dari Firebase seperti berikut:</p>\n<pre><code class="language-bash">FIREBASE_API_KEY= your firebase `apiKey` config\nFIREBASE_AUTH_DOMAIN= your firebase `authDomain` config\nFIREBASE_DATABASE_URL= your firebase `databaseURL` config\nFIREBASE_PROJECT_ID= your firebase `projectId` config\nFIREBASE_STORAGE_BUCKET= your firebase `storageBucket` config\nFIREBASE_MESSAGING_SENDER_ID= your firebase `messagingSenderId` config\n</code></pre>\n<p>Di Nuxt.js saya menambahkan module <code>@nuxtjs/dotenv</code> di file <code>nuxt.config.js</code> agar bisa membaca nilai dari <code>.env</code> ini, namun belakangan saya mendapati kalau nilai ini tidak diganti ketika proses generate file static dilakukan oleh Nuxt. Saya perlu menambahkan kode berikut pada file <code>nuxt.config.js</code> saya:</p>\n<pre><code class="language-javascript">module.exports = {\n  env: {\n    FIREBASE_API_KEY: process.env.FIREBASE_API_KEY,\n    FIREBASE_AUTH_DOMAIN: process.env.FIREBASE_AUTH_DOMAIN,\n    FIREBASE_DATABASE_URL: process.env.FIREBASE_DATABASE_URL,\n    FIREBASE_PROJECT_ID: process.env.FIREBASE_PROJECT_ID,\n    FIREBASE_STORAGE_BUCKET: process.env.FIREBASE_STORAGE_BUCKET,\n    FIREBASE_MESSAGING_SENDER_ID: process.env.FIREBASE_MESSAGING_SENDER_ID\n  },\n}\n</code></pre>\n<h2>Menyiapkan Kode Konfigurasi</h2>\n<p>Untuk membuka koneksi ke Firebase, saya membutuhkan dependency <code>firebase</code> yang bisa dipasang lewat perintah</p>\n<pre><code class="language-bash">$ yarn add firebase\n# atau\n$ npm i firebase\n</code></pre>\n<p>Saya memilih untuk meletakan koneksi firebase ini ke dalam folder <code>plugins</code> di struktur Nuxt, ini artinya akan ditambahkan di semua halaman yang ada di dalam projek ini.</p>\n<p>Saya membuat file <code>plugins/firebase.js</code> dan membuat koneksi ke Firebase dengan kode berikut:</p>\n<pre><code class="language-javascript">import Vue from \'vue\'\nconst firebase = require(\'firebase/app\')\nrequire(\'firebase/database\')\n\nvar config = {\n  apiKey: process.env.FIREBASE_API_KEY || \'\',\n  authDomain: process.env.FIREBASE_AUTH_DOMAIN || \'\',\n  databaseURL: process.env.FIREBASE_DATABASE_URL || \'\',\n  projectId: process.env.FIREBASE_PROJECT_ID || \'\',\n  storageBucket: process.env.FIREBASE_STORAGE_BUCKET || \'\',\n  messagingSenderId: process.env.FIREBASE_MESSAGING_SENDER_ID || \'\'\n}\n\nfirebase.initializeApp(config)\nVue.prototype.$firebase = firebase\n</code></pre>\n<p>Selain membuka koneksi ke Firebase saya juga melakukan injeksi objek firebase yang telah disiapkan kedalam <em>instance</em> dari Vue agar mudah dipakai di Vue Component nantinya.</p>\n<p>Saya perlu menambahkan plugins ini di file <code>nuxt.config.js</code> agar terbaca di projek ini dengan kode seperti berikut:</p>\n<pre><code class="language-javascript">module.exports = {\n  plugins: [\n    { src: \'~/plugins/firebase\', ssr: false }\n   ↗️]\n}\n</code></pre>\n<p>Selain harus diinisialisasi, Firebase juga membutuhkan beberapa file seperti <code>firebase.json</code>, <code>.firebaserc</code> dan <code>database.rules.json</code>. File-file ini bisa didapatkan dengan perintah <code>firebase init</code> pada folder root projek kita. Namun sebelum itu kalian harus login ke dalam firebase terlebih dahulu dengan perintah <code>firebase login</code>.</p>\n<p>Berikut contoh file <code>firebase.json</code> yang bisa kalian temui juga di projek ini:</p>\n<pre><code class="language-javascript">{\n  &quot;database&quot;: {\n    &quot;rules&quot;: &quot;database.rules.json&quot;\n  }\n}\n</code></pre>\n<p>Dan file <code>database.rules.json</code> seperti berikut yang artinya saya membiarkan pengguna mengakses database saya tanpa perlu login terlebih dahulu.</p>\n<pre><code class="language-javascript">{\n  &quot;rules&quot;: {\n    &quot;.read&quot;: &quot;auth == null&quot;,\n    &quot;.write&quot;: &quot;auth == null&quot;\n  }\n}\n</code></pre>\n<h2>Menyiapkan Struktur Data</h2>\n<p>Struktur data dari Firebase DB ini tidak seperti basis data relasional, Firebase DB lebih seperti file JSON file biasa.</p>\n<p>Saya membuat struktur data untuk menyimpan jumlah like pada setiap artikel seperti berikut:</p>\n<pre><code class="language-javascript">{\n  &quot;claps&quot;: {\n    &quot;create-simple-like-button-using-firebase-rtdb&quot;:0,&quot;eslint-formatter-html-extended&quot;:0,\n    &quot;blog-2-0-in-nuxtjs&quot;:0\n  }\n}\n</code></pre>\n<p>Jika kalian malas, kalian juga bisa melakukan import dari data JSON yang sudah saya siapkan di file <code>firebase-db-export.json</code> pada projek Blog 2.0.</p>\n<p>Jangan lupa untuk membuka akses untuk <em>read</em> dan <em>write</em> pada tab <code>Rules</code>:</p>\n<pre><code class="language-javascript">{\n  &quot;rules&quot;: {\n    &quot;.read&quot;: true,\n    &quot;.write&quot;: true\n  }\n}\n</code></pre>\n<h2>Membaca dan Memperbarui Data</h2>\n<p>Firebase terbilang cukup mudah untuk digunakan dengan Vue ataupun Nuxt, kita akan mencoba membaca data yang telah kita buat di Firebase DB di dalam Vue Component kita.</p>\n<p>Saya meletakan di <em>life cycle</em> <code>mounted</code> di Vue Component kode berikut:</p>\n<pre><code class="language-javascript">// this is vue component instance\nconst __self = this\nconst REF_URL = \'claps/\' + __self.meta.slug\n__self.clapsRefs = __self.$firebase.database().ref(REF_URL)\n__self.clapsRefs.once(\'value\').then(function (snapshot) {\n  __self.claps = snapshot.val()\n})\n</code></pre>\n<p>Sebelumnya tentu saya harus menyiapkan state <code>clapsRefs</code> dan <code>claps</code> di bagian <code>data ()</code> sebagai penampung nilai tersebut.</p>\n<p>Kode diatas digunakan untuk menginisialisai nilai berdasarkan data yang ada di Firebase DB, bagaimana kalau ada perubahan nilai pada Firebase DB kita? karena kita menggunakan Firebase Realtime-DB maka akan sangat mudah bagi kita untuk mendengarkan setiap perubahan yang terjadi dan saar itu pula langsung bereaksi dengan memperbarui tampilan jumlah <em>like</em> yang ditampilkan. Kode untuk mendengarkan perubahan secara realtime kurang lebih sebagai berikut:</p>\n<pre><code class="language-javascript">// this is vue component instance\nconst __self = this\n__self.clapsRefs.on(\'value\', function (snapshot) {\n  __self.claps = snapshot.val()\n})\n</code></pre>\n<p>Sementara untuk memperbarui nilai di DB kita juga tidak kalah mudahnya, cukup dengan kode <code>set</code> pada referensi yang telah kita dapatkan, seperti contoh berikut:</p>\n<pre><code class="language-javascript">// this is vue component instance\nif (this.clapsRefs) {\n  this.clapsRefs.set(this.claps + 1)\n}\n</code></pre>\n<h2>Travis CI Konfigurasi</h2>\n<p>Sentuhan terkhir adalah memastikan ketika proses build kita menyetel nilai <em>environment variable</em> dengan nilai asli sesuai dengan apa yang kita gunakan di prodcution. Bila pada saat di lokal kita bisa menggunakan file <code>.env</code> yang tidak mungkin kita push ke repository.</p>\n<p>Di <a href="https://travis-ci.org">Travis CI ↗️</a> kita juga bisa menyetel berbagai variabel dengan mudah. Cukup masuk ke bagian <code>settings</code> dan kita bisa menambahkan <em>key-value</em> sebagai variabel yang akan diikutkan saat proses <em>build</em>.</p>\n<img v-lazyload src="/images/placeholder-1x1.png" data-src="/content-images/create-simple-like-button-using-firebase-rtdb/travis-ci-env.png" alt="Travis CI Environment Variable" height="200px" width="200px">\n<h3>Demikian artikel kali ini, semoga bermanfaat...</h3>\n'}}}]);